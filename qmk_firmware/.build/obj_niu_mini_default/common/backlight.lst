   1               		.file	"backlight.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.backlight_init,"ax",@progbits
  11               	.global	backlight_init
  13               	backlight_init:
  14               	.LFB1:
  15               		.file 1 "tmk_core/common/backlight.c"
   1:tmk_core/common/backlight.c **** /*
   2:tmk_core/common/backlight.c **** Copyright 2013 Mathias Andersson <wraul@dbox.se>
   3:tmk_core/common/backlight.c **** 
   4:tmk_core/common/backlight.c **** This program is free software: you can redistribute it and/or modify
   5:tmk_core/common/backlight.c **** it under the terms of the GNU General Public License as published by
   6:tmk_core/common/backlight.c **** the Free Software Foundation, either version 2 of the License, or
   7:tmk_core/common/backlight.c **** (at your option) any later version.
   8:tmk_core/common/backlight.c **** 
   9:tmk_core/common/backlight.c **** This program is distributed in the hope that it will be useful,
  10:tmk_core/common/backlight.c **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:tmk_core/common/backlight.c **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:tmk_core/common/backlight.c **** GNU General Public License for more details.
  13:tmk_core/common/backlight.c **** 
  14:tmk_core/common/backlight.c **** You should have received a copy of the GNU General Public License
  15:tmk_core/common/backlight.c **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:tmk_core/common/backlight.c **** */
  17:tmk_core/common/backlight.c **** 
  18:tmk_core/common/backlight.c **** #include "backlight.h"
  19:tmk_core/common/backlight.c **** #include "eeconfig.h"
  20:tmk_core/common/backlight.c **** #include "debug.h"
  21:tmk_core/common/backlight.c **** 
  22:tmk_core/common/backlight.c **** backlight_config_t backlight_config;
  23:tmk_core/common/backlight.c **** 
  24:tmk_core/common/backlight.c **** /** \brief Backlight initialization
  25:tmk_core/common/backlight.c ****  *
  26:tmk_core/common/backlight.c ****  * FIXME: needs doc
  27:tmk_core/common/backlight.c ****  */
  28:tmk_core/common/backlight.c **** void backlight_init(void)
  29:tmk_core/common/backlight.c **** {
  16               		.loc 1 29 1 view -0
  17               		.cfi_startproc
  18               	/* prologue: function */
  19               	/* frame size = 0 */
  20               	/* stack size = 0 */
  21               	.L__stack_usage = 0
  30:tmk_core/common/backlight.c ****     /* check signature */
  31:tmk_core/common/backlight.c ****     if (!eeconfig_is_enabled()) {
  22               		.loc 1 31 5 view .LVU1
  23               		.loc 1 31 10 is_stmt 0 view .LVU2
  24 0000 0E94 0000 		call eeconfig_is_enabled
  25               	.LVL0:
  26               		.loc 1 31 8 view .LVU3
  27 0004 8111      		cpse r24,__zero_reg__
  28 0006 00C0      		rjmp .L2
  32:tmk_core/common/backlight.c ****         eeconfig_init();
  29               		.loc 1 32 9 is_stmt 1 view .LVU4
  30 0008 0E94 0000 		call eeconfig_init
  31               	.LVL1:
  32               	.L2:
  33:tmk_core/common/backlight.c ****     }
  34:tmk_core/common/backlight.c ****     backlight_config.raw = eeconfig_read_backlight();
  33               		.loc 1 34 5 view .LVU5
  34               		.loc 1 34 28 is_stmt 0 view .LVU6
  35 000c 0E94 0000 		call eeconfig_read_backlight
  36               	.LVL2:
  37               		.loc 1 34 26 view .LVU7
  38 0010 8093 0000 		sts backlight_config,r24
  35:tmk_core/common/backlight.c ****     if (backlight_config.level > BACKLIGHT_LEVELS) {
  39               		.loc 1 35 5 is_stmt 1 view .LVU8
  40               		.loc 1 35 8 is_stmt 0 view .LVU9
  41 0014 8832      		cpi r24,lo8(40)
  42 0016 00F0      		brlo .L3
  36:tmk_core/common/backlight.c ****        backlight_config.level = BACKLIGHT_LEVELS;
  43               		.loc 1 36 8 is_stmt 1 view .LVU10
  44               		.loc 1 36 31 is_stmt 0 view .LVU11
  45 0018 8770      		andi r24,lo8(7)
  46 001a 8062      		ori r24,lo8(32)
  47 001c 8093 0000 		sts backlight_config,r24
  48               	.L3:
  37:tmk_core/common/backlight.c ****     }
  38:tmk_core/common/backlight.c ****     backlight_set(backlight_config.enable ? backlight_config.level : 0);
  49               		.loc 1 38 5 is_stmt 1 view .LVU12
  50               		.loc 1 38 43 is_stmt 0 view .LVU13
  51 0020 9091 0000 		lds r25,backlight_config
  52               		.loc 1 38 5 view .LVU14
  53 0024 892F      		mov r24,r25
  54 0026 8170      		andi r24,lo8(1)
  55 0028 90FF      		sbrs r25,0
  56 002a 00C0      		rjmp .L4
  57               		.loc 1 38 61 discriminator 1 view .LVU15
  58 002c 892F      		mov r24,r25
  59 002e 8695      		lsr r24
  60 0030 8695      		lsr r24
  61 0032 8695      		lsr r24
  62               	.L4:
  63               		.loc 1 38 5 discriminator 4 view .LVU16
  64 0034 0C94 0000 		jmp backlight_set
  65               	.LVL3:
  66               		.cfi_endproc
  67               	.LFE1:
  69               		.section	.text.backlight_increase,"ax",@progbits
  70               	.global	backlight_increase
  72               	backlight_increase:
  73               	.LFB2:
  39:tmk_core/common/backlight.c **** }
  40:tmk_core/common/backlight.c **** 
  41:tmk_core/common/backlight.c **** /** \brief Backlight increase
  42:tmk_core/common/backlight.c ****  *
  43:tmk_core/common/backlight.c ****  * FIXME: needs doc
  44:tmk_core/common/backlight.c ****  */
  45:tmk_core/common/backlight.c **** void backlight_increase(void)
  46:tmk_core/common/backlight.c **** {
  74               		.loc 1 46 1 is_stmt 1 view -0
  75               		.cfi_startproc
  76               	/* prologue: function */
  77               	/* frame size = 0 */
  78               	/* stack size = 0 */
  79               	.L__stack_usage = 0
  47:tmk_core/common/backlight.c ****     if(backlight_config.level < BACKLIGHT_LEVELS)
  80               		.loc 1 47 5 view .LVU18
  81               		.loc 1 47 24 is_stmt 0 view .LVU19
  82 0000 8091 0000 		lds r24,backlight_config
  83 0004 982F      		mov r25,r24
  84 0006 9695      		lsr r25
  85 0008 9695      		lsr r25
  86 000a 9695      		lsr r25
  87               		.loc 1 47 7 view .LVU20
  88 000c 9430      		cpi r25,lo8(4)
  89 000e 00F4      		brsh .L9
  48:tmk_core/common/backlight.c ****     {
  49:tmk_core/common/backlight.c ****         backlight_config.level++;
  90               		.loc 1 49 9 is_stmt 1 view .LVU21
  91               		.loc 1 49 31 is_stmt 0 view .LVU22
  92 0010 9F5F      		subi r25,lo8(-(1))
  93 0012 990F      		lsl r25
  94 0014 990F      		lsl r25
  95 0016 990F      		lsl r25
  96 0018 8770      		andi r24,lo8(7)
  97 001a 892B      		or r24,r25
  98 001c 8093 0000 		sts backlight_config,r24
  99               	.L9:
  50:tmk_core/common/backlight.c ****     }
  51:tmk_core/common/backlight.c ****     backlight_config.enable = 1;
 100               		.loc 1 51 5 is_stmt 1 view .LVU23
 101               		.loc 1 51 29 is_stmt 0 view .LVU24
 102 0020 8091 0000 		lds r24,backlight_config
 103 0024 8160      		ori r24,lo8(1<<0)
 104 0026 8093 0000 		sts backlight_config,r24
  52:tmk_core/common/backlight.c ****     eeconfig_update_backlight(backlight_config.raw);
 105               		.loc 1 52 5 is_stmt 1 view .LVU25
 106 002a 0E94 0000 		call eeconfig_update_backlight
 107               	.LVL4:
  53:tmk_core/common/backlight.c ****     dprintf("backlight increase: %u\n", backlight_config.level);
 108               		.loc 1 53 5 view .LVU26
 109               		.loc 1 53 5 view .LVU27
 110 002e 8091 0000 		lds r24,debug_config
 111 0032 80FF      		sbrs r24,0
 112 0034 00C0      		rjmp .L10
 113               		.loc 1 53 5 discriminator 1 view .LVU28
 114               	.LBB2:
 115               		.loc 1 53 5 discriminator 1 view .LVU29
 116               		.loc 1 53 5 discriminator 1 view .LVU30
 117               	.LBE2:
 118 0036 8091 0000 		lds r24,backlight_config
 119 003a 8695      		lsr r24
 120 003c 8695      		lsr r24
 121 003e 8695      		lsr r24
 122 0040 1F92      		push __zero_reg__
 123               	.LCFI0:
 124               		.cfi_def_cfa_offset 3
 125 0042 8F93      		push r24
 126               	.LCFI1:
 127               		.cfi_def_cfa_offset 4
 128 0044 80E0      		ldi r24,lo8(__c.1829)
 129 0046 90E0      		ldi r25,hi8(__c.1829)
 130 0048 9F93      		push r25
 131               	.LCFI2:
 132               		.cfi_def_cfa_offset 5
 133 004a 8F93      		push r24
 134               	.LCFI3:
 135               		.cfi_def_cfa_offset 6
 136 004c 0E94 0000 		call __xprintf
 137               	.LVL5:
 138 0050 0F90      		pop __tmp_reg__
 139 0052 0F90      		pop __tmp_reg__
 140 0054 0F90      		pop __tmp_reg__
 141 0056 0F90      		pop __tmp_reg__
 142               	.LCFI4:
 143               		.cfi_def_cfa_offset 2
 144               	.L10:
  54:tmk_core/common/backlight.c ****     backlight_set(backlight_config.level);
 145               		.loc 1 54 5 view .LVU31
 146               		.loc 1 54 35 is_stmt 0 view .LVU32
 147 0058 8091 0000 		lds r24,backlight_config
 148               		.loc 1 54 5 view .LVU33
 149 005c 8695      		lsr r24
 150 005e 8695      		lsr r24
 151 0060 8695      		lsr r24
 152 0062 0C94 0000 		jmp backlight_set
 153               	.LVL6:
 154               		.cfi_endproc
 155               	.LFE2:
 157               		.section	.text.backlight_decrease,"ax",@progbits
 158               	.global	backlight_decrease
 160               	backlight_decrease:
 161               	.LFB3:
  55:tmk_core/common/backlight.c **** }
  56:tmk_core/common/backlight.c **** 
  57:tmk_core/common/backlight.c **** /** \brief Backlight decrease
  58:tmk_core/common/backlight.c ****  *
  59:tmk_core/common/backlight.c ****  * FIXME: needs doc
  60:tmk_core/common/backlight.c ****  */
  61:tmk_core/common/backlight.c **** void backlight_decrease(void)
  62:tmk_core/common/backlight.c **** {
 162               		.loc 1 62 1 is_stmt 1 view -0
 163               		.cfi_startproc
 164               	/* prologue: function */
 165               	/* frame size = 0 */
 166               	/* stack size = 0 */
 167               	.L__stack_usage = 0
  63:tmk_core/common/backlight.c ****     if(backlight_config.level > 0)
 168               		.loc 1 63 5 view .LVU35
 169               		.loc 1 63 31 is_stmt 0 view .LVU36
 170 0000 8091 0000 		lds r24,backlight_config
 171 0004 982F      		mov r25,r24
 172 0006 987F      		andi r25,lo8(-8)
 173               		.loc 1 63 7 view .LVU37
 174 0008 01F0      		breq .L15
  64:tmk_core/common/backlight.c ****     {
  65:tmk_core/common/backlight.c ****         backlight_config.level--;
 175               		.loc 1 65 9 is_stmt 1 view .LVU38
 176               		.loc 1 65 31 is_stmt 0 view .LVU39
 177 000a 8850      		subi r24,lo8(-(-8))
 178 000c 8093 0000 		sts backlight_config,r24
  66:tmk_core/common/backlight.c ****         backlight_config.enable = !!backlight_config.level;
 179               		.loc 1 66 9 is_stmt 1 view .LVU40
 180               		.loc 1 66 35 is_stmt 0 view .LVU41
 181 0010 887F      		andi r24,lo8(-8)
 182 0012 91E0      		ldi r25,lo8(1)
 183 0014 01F4      		brne .L16
 184 0016 90E0      		ldi r25,0
 185               	.L16:
 186               		.loc 1 66 33 view .LVU42
 187 0018 8091 0000 		lds r24,backlight_config
 188 001c 90FB      		bst r25,0
 189 001e 80F9      		bld r24,0
 190 0020 8093 0000 		sts backlight_config,r24
  67:tmk_core/common/backlight.c ****         eeconfig_update_backlight(backlight_config.raw);
 191               		.loc 1 67 9 is_stmt 1 view .LVU43
 192 0024 0E94 0000 		call eeconfig_update_backlight
 193               	.LVL7:
 194               	.L15:
  68:tmk_core/common/backlight.c ****     }
  69:tmk_core/common/backlight.c ****     dprintf("backlight decrease: %u\n", backlight_config.level);
 195               		.loc 1 69 5 view .LVU44
 196               		.loc 1 69 5 view .LVU45
 197 0028 8091 0000 		lds r24,debug_config
 198 002c 80FF      		sbrs r24,0
 199 002e 00C0      		rjmp .L17
 200               		.loc 1 69 5 discriminator 1 view .LVU46
 201               	.LBB3:
 202               		.loc 1 69 5 discriminator 1 view .LVU47
 203               		.loc 1 69 5 discriminator 1 view .LVU48
 204               	.LBE3:
 205 0030 8091 0000 		lds r24,backlight_config
 206 0034 8695      		lsr r24
 207 0036 8695      		lsr r24
 208 0038 8695      		lsr r24
 209 003a 1F92      		push __zero_reg__
 210               	.LCFI5:
 211               		.cfi_def_cfa_offset 3
 212 003c 8F93      		push r24
 213               	.LCFI6:
 214               		.cfi_def_cfa_offset 4
 215 003e 80E0      		ldi r24,lo8(__c.1834)
 216 0040 90E0      		ldi r25,hi8(__c.1834)
 217 0042 9F93      		push r25
 218               	.LCFI7:
 219               		.cfi_def_cfa_offset 5
 220 0044 8F93      		push r24
 221               	.LCFI8:
 222               		.cfi_def_cfa_offset 6
 223 0046 0E94 0000 		call __xprintf
 224               	.LVL8:
 225 004a 0F90      		pop __tmp_reg__
 226 004c 0F90      		pop __tmp_reg__
 227 004e 0F90      		pop __tmp_reg__
 228 0050 0F90      		pop __tmp_reg__
 229               	.LCFI9:
 230               		.cfi_def_cfa_offset 2
 231               	.L17:
  70:tmk_core/common/backlight.c ****     backlight_set(backlight_config.level);
 232               		.loc 1 70 5 view .LVU49
 233               		.loc 1 70 35 is_stmt 0 view .LVU50
 234 0052 8091 0000 		lds r24,backlight_config
 235               		.loc 1 70 5 view .LVU51
 236 0056 8695      		lsr r24
 237 0058 8695      		lsr r24
 238 005a 8695      		lsr r24
 239 005c 0C94 0000 		jmp backlight_set
 240               	.LVL9:
 241               		.cfi_endproc
 242               	.LFE3:
 244               		.section	.text.backlight_enable,"ax",@progbits
 245               	.global	backlight_enable
 247               	backlight_enable:
 248               	.LFB5:
  71:tmk_core/common/backlight.c **** }
  72:tmk_core/common/backlight.c **** 
  73:tmk_core/common/backlight.c **** /** \brief Backlight toggle
  74:tmk_core/common/backlight.c ****  *
  75:tmk_core/common/backlight.c ****  * FIXME: needs doc
  76:tmk_core/common/backlight.c ****  */
  77:tmk_core/common/backlight.c **** void backlight_toggle(void)
  78:tmk_core/common/backlight.c **** {
  79:tmk_core/common/backlight.c **** 	bool enabled = backlight_config.enable;
  80:tmk_core/common/backlight.c **** 	dprintf("backlight toggle: %u\n", enabled);
  81:tmk_core/common/backlight.c **** 	if (enabled) 
  82:tmk_core/common/backlight.c **** 		backlight_disable();
  83:tmk_core/common/backlight.c **** 	else
  84:tmk_core/common/backlight.c **** 		backlight_enable();
  85:tmk_core/common/backlight.c **** }
  86:tmk_core/common/backlight.c **** 
  87:tmk_core/common/backlight.c **** /** \brief Enable backlight
  88:tmk_core/common/backlight.c ****  *
  89:tmk_core/common/backlight.c ****  * FIXME: needs doc
  90:tmk_core/common/backlight.c ****  */
  91:tmk_core/common/backlight.c **** void backlight_enable(void)
  92:tmk_core/common/backlight.c **** {
 249               		.loc 1 92 1 is_stmt 1 view -0
 250               		.cfi_startproc
 251               	/* prologue: function */
 252               	/* frame size = 0 */
 253               	/* stack size = 0 */
 254               	.L__stack_usage = 0
  93:tmk_core/common/backlight.c **** 	if (backlight_config.enable) return; // do nothing if backlight is already on
 255               		.loc 1 93 2 view .LVU53
 256               		.loc 1 93 6 is_stmt 0 view .LVU54
 257 0000 8091 0000 		lds r24,backlight_config
 258               		.loc 1 93 5 view .LVU55
 259 0004 80FD      		sbrc r24,0
 260 0006 00C0      		rjmp .L24
  94:tmk_core/common/backlight.c **** 
  95:tmk_core/common/backlight.c **** 	backlight_config.enable = true;
 261               		.loc 1 95 2 is_stmt 1 view .LVU56
 262               		.loc 1 95 26 is_stmt 0 view .LVU57
 263 0008 8160      		ori r24,lo8(1<<0)
 264 000a 8093 0000 		sts backlight_config,r24
  96:tmk_core/common/backlight.c **** 	if (backlight_config.raw == 1) // enabled but level == 0
 265               		.loc 1 96 2 is_stmt 1 view .LVU58
 266               		.loc 1 96 5 is_stmt 0 view .LVU59
 267 000e 8130      		cpi r24,lo8(1)
 268 0010 01F4      		brne .L26
  97:tmk_core/common/backlight.c **** 		backlight_config.level = 1;
 269               		.loc 1 97 3 is_stmt 1 view .LVU60
 270               		.loc 1 97 26 is_stmt 0 view .LVU61
 271 0012 89E0      		ldi r24,lo8(9)
 272 0014 8093 0000 		sts backlight_config,r24
 273               	.L26:
  98:tmk_core/common/backlight.c **** 	eeconfig_update_backlight(backlight_config.raw);
 274               		.loc 1 98 2 is_stmt 1 view .LVU62
 275 0018 8091 0000 		lds r24,backlight_config
 276 001c 0E94 0000 		call eeconfig_update_backlight
 277               	.LVL10:
  99:tmk_core/common/backlight.c **** 	dprintf("backlight enable\n");
 278               		.loc 1 99 2 view .LVU63
 279               		.loc 1 99 2 view .LVU64
 280 0020 8091 0000 		lds r24,debug_config
 281 0024 80FF      		sbrs r24,0
 282 0026 00C0      		rjmp .L27
 283               		.loc 1 99 2 discriminator 1 view .LVU65
 284               	.LBB4:
 285               		.loc 1 99 2 discriminator 1 view .LVU66
 286               		.loc 1 99 2 discriminator 1 view .LVU67
 287               	.LBE4:
 288 0028 80E0      		ldi r24,lo8(__c.1845)
 289 002a 90E0      		ldi r25,hi8(__c.1845)
 290 002c 9F93      		push r25
 291               	.LCFI10:
 292               		.cfi_def_cfa_offset 3
 293 002e 8F93      		push r24
 294               	.LCFI11:
 295               		.cfi_def_cfa_offset 4
 296 0030 0E94 0000 		call __xprintf
 297               	.LVL11:
 298 0034 0F90      		pop __tmp_reg__
 299 0036 0F90      		pop __tmp_reg__
 300               	.LCFI12:
 301               		.cfi_def_cfa_offset 2
 302               	.L27:
 100:tmk_core/common/backlight.c **** 	backlight_set(backlight_config.level);
 303               		.loc 1 100 2 view .LVU68
 304               		.loc 1 100 32 is_stmt 0 view .LVU69
 305 0038 8091 0000 		lds r24,backlight_config
 306               		.loc 1 100 2 view .LVU70
 307 003c 8695      		lsr r24
 308 003e 8695      		lsr r24
 309 0040 8695      		lsr r24
 310 0042 0C94 0000 		jmp backlight_set
 311               	.LVL12:
 312               	.L24:
 313               	/* epilogue start */
 101:tmk_core/common/backlight.c **** }
 314               		.loc 1 101 1 view .LVU71
 315 0046 0895      		ret
 316               		.cfi_endproc
 317               	.LFE5:
 319               		.section	.text.backlight_disable,"ax",@progbits
 320               	.global	backlight_disable
 322               	backlight_disable:
 323               	.LFB6:
 102:tmk_core/common/backlight.c **** 
 103:tmk_core/common/backlight.c **** /** \brief Disable backlight
 104:tmk_core/common/backlight.c ****  *
 105:tmk_core/common/backlight.c ****  * FIXME: needs doc
 106:tmk_core/common/backlight.c ****  */
 107:tmk_core/common/backlight.c **** void backlight_disable(void)
 108:tmk_core/common/backlight.c **** {
 324               		.loc 1 108 1 is_stmt 1 view -0
 325               		.cfi_startproc
 326               	/* prologue: function */
 327               	/* frame size = 0 */
 328               	/* stack size = 0 */
 329               	.L__stack_usage = 0
 109:tmk_core/common/backlight.c **** 	if (!backlight_config.enable) return; // do nothing if backlight is already off
 330               		.loc 1 109 2 view .LVU73
 331               		.loc 1 109 23 is_stmt 0 view .LVU74
 332 0000 8091 0000 		lds r24,backlight_config
 333               		.loc 1 109 5 view .LVU75
 334 0004 80FF      		sbrs r24,0
 335 0006 00C0      		rjmp .L31
 110:tmk_core/common/backlight.c **** 
 111:tmk_core/common/backlight.c **** 	backlight_config.enable = false;
 336               		.loc 1 111 2 is_stmt 1 view .LVU76
 337               		.loc 1 111 26 is_stmt 0 view .LVU77
 338 0008 8E7F      		andi r24,lo8(~(1<<0))
 339 000a 8093 0000 		sts backlight_config,r24
 112:tmk_core/common/backlight.c **** 	eeconfig_update_backlight(backlight_config.raw);
 340               		.loc 1 112 2 is_stmt 1 view .LVU78
 341 000e 0E94 0000 		call eeconfig_update_backlight
 342               	.LVL13:
 113:tmk_core/common/backlight.c **** 	dprintf("backlight disable\n");
 343               		.loc 1 113 2 view .LVU79
 344               		.loc 1 113 2 view .LVU80
 345 0012 8091 0000 		lds r24,debug_config
 346 0016 80FF      		sbrs r24,0
 347 0018 00C0      		rjmp .L33
 348               		.loc 1 113 2 discriminator 1 view .LVU81
 349               	.LBB5:
 350               		.loc 1 113 2 discriminator 1 view .LVU82
 351               		.loc 1 113 2 discriminator 1 view .LVU83
 352               	.LBE5:
 353 001a 80E0      		ldi r24,lo8(__c.1850)
 354 001c 90E0      		ldi r25,hi8(__c.1850)
 355 001e 9F93      		push r25
 356               	.LCFI13:
 357               		.cfi_def_cfa_offset 3
 358 0020 8F93      		push r24
 359               	.LCFI14:
 360               		.cfi_def_cfa_offset 4
 361 0022 0E94 0000 		call __xprintf
 362               	.LVL14:
 363 0026 0F90      		pop __tmp_reg__
 364 0028 0F90      		pop __tmp_reg__
 365               	.LCFI15:
 366               		.cfi_def_cfa_offset 2
 367               	.L33:
 114:tmk_core/common/backlight.c **** 	backlight_set(0);
 368               		.loc 1 114 2 view .LVU84
 369 002a 80E0      		ldi r24,0
 370 002c 0C94 0000 		jmp backlight_set
 371               	.LVL15:
 372               	.L31:
 373               	/* epilogue start */
 115:tmk_core/common/backlight.c **** }
 374               		.loc 1 115 1 is_stmt 0 view .LVU85
 375 0030 0895      		ret
 376               		.cfi_endproc
 377               	.LFE6:
 379               		.section	.text.backlight_toggle,"ax",@progbits
 380               	.global	backlight_toggle
 382               	backlight_toggle:
 383               	.LFB4:
  78:tmk_core/common/backlight.c **** 	bool enabled = backlight_config.enable;
 384               		.loc 1 78 1 is_stmt 1 view -0
 385               		.cfi_startproc
 386 0000 CF93      		push r28
 387               	.LCFI16:
 388               		.cfi_def_cfa_offset 3
 389               		.cfi_offset 28, -2
 390               	/* prologue: function */
 391               	/* frame size = 0 */
 392               	/* stack size = 1 */
 393               	.L__stack_usage = 1
  79:tmk_core/common/backlight.c **** 	dprintf("backlight toggle: %u\n", enabled);
 394               		.loc 1 79 2 view .LVU87
  79:tmk_core/common/backlight.c **** 	dprintf("backlight toggle: %u\n", enabled);
 395               		.loc 1 79 7 is_stmt 0 view .LVU88
 396 0002 C091 0000 		lds r28,backlight_config
 397 0006 C170      		andi r28,1
 398               	.LVL16:
  80:tmk_core/common/backlight.c **** 	if (enabled) 
 399               		.loc 1 80 2 is_stmt 1 view .LVU89
  80:tmk_core/common/backlight.c **** 	if (enabled) 
 400               		.loc 1 80 2 view .LVU90
 401 0008 8091 0000 		lds r24,debug_config
 402 000c 80FF      		sbrs r24,0
 403 000e 00C0      		rjmp .L38
  80:tmk_core/common/backlight.c **** 	if (enabled) 
 404               		.loc 1 80 2 discriminator 1 view .LVU91
 405               	.LBB6:
  80:tmk_core/common/backlight.c **** 	if (enabled) 
 406               		.loc 1 80 2 discriminator 1 view .LVU92
  80:tmk_core/common/backlight.c **** 	if (enabled) 
 407               		.loc 1 80 2 discriminator 1 view .LVU93
 408               	.LBE6:
 409 0010 1F92      		push __zero_reg__
 410               	.LCFI17:
 411               		.cfi_def_cfa_offset 4
 412 0012 CF93      		push r28
 413               	.LCFI18:
 414               		.cfi_def_cfa_offset 5
 415 0014 80E0      		ldi r24,lo8(__c.1840)
 416 0016 90E0      		ldi r25,hi8(__c.1840)
 417 0018 9F93      		push r25
 418               	.LCFI19:
 419               		.cfi_def_cfa_offset 6
 420 001a 8F93      		push r24
 421               	.LCFI20:
 422               		.cfi_def_cfa_offset 7
 423 001c 0E94 0000 		call __xprintf
 424               	.LVL17:
 425 0020 0F90      		pop __tmp_reg__
 426 0022 0F90      		pop __tmp_reg__
 427 0024 0F90      		pop __tmp_reg__
 428 0026 0F90      		pop __tmp_reg__
 429               	.LCFI21:
 430               		.cfi_def_cfa_offset 3
 431               	.L38:
  81:tmk_core/common/backlight.c **** 		backlight_disable();
 432               		.loc 1 81 2 view .LVU94
  81:tmk_core/common/backlight.c **** 		backlight_disable();
 433               		.loc 1 81 5 is_stmt 0 view .LVU95
 434 0028 CC23      		tst r28
 435 002a 01F0      		breq .L39
  82:tmk_core/common/backlight.c **** 	else
 436               		.loc 1 82 3 is_stmt 1 view .LVU96
 437               	/* epilogue start */
  85:tmk_core/common/backlight.c **** 
 438               		.loc 1 85 1 is_stmt 0 view .LVU97
 439 002c CF91      		pop r28
 440               	.LVL18:
  82:tmk_core/common/backlight.c **** 	else
 441               		.loc 1 82 3 view .LVU98
 442 002e 0C94 0000 		jmp backlight_disable
 443               	.LVL19:
 444               	.L39:
  84:tmk_core/common/backlight.c **** }
 445               		.loc 1 84 3 is_stmt 1 view .LVU99
 446               	/* epilogue start */
  85:tmk_core/common/backlight.c **** 
 447               		.loc 1 85 1 is_stmt 0 view .LVU100
 448 0032 CF91      		pop r28
 449               	.LVL20:
  84:tmk_core/common/backlight.c **** }
 450               		.loc 1 84 3 view .LVU101
 451 0034 0C94 0000 		jmp backlight_enable
 452               	.LVL21:
 453               		.cfi_endproc
 454               	.LFE4:
 456               		.section	.text.is_backlight_enabled,"ax",@progbits
 457               	.global	is_backlight_enabled
 459               	is_backlight_enabled:
 460               	.LFB7:
 116:tmk_core/common/backlight.c **** 
 117:tmk_core/common/backlight.c **** /** /brief Get the backlight status
 118:tmk_core/common/backlight.c ****  *
 119:tmk_core/common/backlight.c ****  * FIXME: needs doc
 120:tmk_core/common/backlight.c ****  */
 121:tmk_core/common/backlight.c **** bool is_backlight_enabled(void)
 122:tmk_core/common/backlight.c **** {
 461               		.loc 1 122 1 is_stmt 1 view -0
 462               		.cfi_startproc
 463               	/* prologue: function */
 464               	/* frame size = 0 */
 465               	/* stack size = 0 */
 466               	.L__stack_usage = 0
 123:tmk_core/common/backlight.c **** 	return backlight_config.enable;
 467               		.loc 1 123 2 view .LVU103
 468               		.loc 1 123 25 is_stmt 0 view .LVU104
 469 0000 8091 0000 		lds r24,backlight_config
 124:tmk_core/common/backlight.c **** }
 470               		.loc 1 124 1 view .LVU105
 471 0004 8170      		andi r24,lo8(1)
 472               	/* epilogue start */
 473 0006 0895      		ret
 474               		.cfi_endproc
 475               	.LFE7:
 477               		.section	.text.backlight_step,"ax",@progbits
 478               	.global	backlight_step
 480               	backlight_step:
 481               	.LFB8:
 125:tmk_core/common/backlight.c **** 
 126:tmk_core/common/backlight.c **** /** \brief Backlight step through levels
 127:tmk_core/common/backlight.c ****  *
 128:tmk_core/common/backlight.c ****  * FIXME: needs doc
 129:tmk_core/common/backlight.c ****  */
 130:tmk_core/common/backlight.c **** void backlight_step(void)
 131:tmk_core/common/backlight.c **** {
 482               		.loc 1 131 1 is_stmt 1 view -0
 483               		.cfi_startproc
 484               	/* prologue: function */
 485               	/* frame size = 0 */
 486               	/* stack size = 0 */
 487               	.L__stack_usage = 0
 132:tmk_core/common/backlight.c ****     backlight_config.level++;
 488               		.loc 1 132 5 view .LVU107
 489               		.loc 1 132 21 is_stmt 0 view .LVU108
 490 0000 9091 0000 		lds r25,backlight_config
 491 0004 892F      		mov r24,r25
 492 0006 8695      		lsr r24
 493 0008 8695      		lsr r24
 494 000a 8695      		lsr r24
 495               		.loc 1 132 27 view .LVU109
 496 000c 8F5F      		subi r24,lo8(-(1))
 497 000e 8F71      		andi r24,lo8(31)
 133:tmk_core/common/backlight.c ****     if(backlight_config.level > BACKLIGHT_LEVELS)
 498               		.loc 1 133 5 is_stmt 1 view .LVU110
 499 0010 9770      		andi r25,lo8(7)
 500               		.loc 1 133 7 is_stmt 0 view .LVU111
 501 0012 8530      		cpi r24,lo8(5)
 502 0014 00F4      		brsh .L45
 132:tmk_core/common/backlight.c ****     backlight_config.level++;
 503               		.loc 1 132 27 view .LVU112
 504 0016 880F      		lsl r24
 505 0018 880F      		lsl r24
 506 001a 880F      		lsl r24
 507 001c 892B      		or r24,r25
 508 001e 8093 0000 		sts backlight_config,r24
 509               	.L46:
 134:tmk_core/common/backlight.c ****     {
 135:tmk_core/common/backlight.c ****         backlight_config.level = 0;
 136:tmk_core/common/backlight.c ****     }
 137:tmk_core/common/backlight.c ****     backlight_config.enable = !!backlight_config.level;
 510               		.loc 1 137 5 is_stmt 1 view .LVU113
 511               		.loc 1 137 31 is_stmt 0 view .LVU114
 512 0022 8091 0000 		lds r24,backlight_config
 513 0026 887F      		andi r24,lo8(-8)
 514 0028 91E0      		ldi r25,lo8(1)
 515 002a 01F4      		brne .L47
 516 002c 90E0      		ldi r25,0
 517               	.L47:
 518               		.loc 1 137 29 view .LVU115
 519 002e 8091 0000 		lds r24,backlight_config
 520 0032 90FB      		bst r25,0
 521 0034 80F9      		bld r24,0
 522 0036 8093 0000 		sts backlight_config,r24
 138:tmk_core/common/backlight.c ****     eeconfig_update_backlight(backlight_config.raw);
 523               		.loc 1 138 5 is_stmt 1 view .LVU116
 524 003a 0E94 0000 		call eeconfig_update_backlight
 525               	.LVL22:
 139:tmk_core/common/backlight.c ****     dprintf("backlight step: %u\n", backlight_config.level);
 526               		.loc 1 139 5 view .LVU117
 527               		.loc 1 139 5 view .LVU118
 528 003e 8091 0000 		lds r24,debug_config
 529 0042 80FF      		sbrs r24,0
 530 0044 00C0      		rjmp .L48
 531               		.loc 1 139 5 discriminator 1 view .LVU119
 532               	.LBB7:
 533               		.loc 1 139 5 discriminator 1 view .LVU120
 534               		.loc 1 139 5 discriminator 1 view .LVU121
 535               	.LBE7:
 536 0046 8091 0000 		lds r24,backlight_config
 537 004a 8695      		lsr r24
 538 004c 8695      		lsr r24
 539 004e 8695      		lsr r24
 540 0050 1F92      		push __zero_reg__
 541               	.LCFI22:
 542               		.cfi_def_cfa_offset 3
 543 0052 8F93      		push r24
 544               	.LCFI23:
 545               		.cfi_def_cfa_offset 4
 546 0054 80E0      		ldi r24,lo8(__c.1858)
 547 0056 90E0      		ldi r25,hi8(__c.1858)
 548 0058 9F93      		push r25
 549               	.LCFI24:
 550               		.cfi_def_cfa_offset 5
 551 005a 8F93      		push r24
 552               	.LCFI25:
 553               		.cfi_def_cfa_offset 6
 554 005c 0E94 0000 		call __xprintf
 555               	.LVL23:
 556 0060 0F90      		pop __tmp_reg__
 557 0062 0F90      		pop __tmp_reg__
 558 0064 0F90      		pop __tmp_reg__
 559 0066 0F90      		pop __tmp_reg__
 560               	.LCFI26:
 561               		.cfi_def_cfa_offset 2
 562               	.L48:
 140:tmk_core/common/backlight.c ****     backlight_set(backlight_config.level);
 563               		.loc 1 140 5 view .LVU122
 564               		.loc 1 140 35 is_stmt 0 view .LVU123
 565 0068 8091 0000 		lds r24,backlight_config
 566               		.loc 1 140 5 view .LVU124
 567 006c 8695      		lsr r24
 568 006e 8695      		lsr r24
 569 0070 8695      		lsr r24
 570 0072 0C94 0000 		jmp backlight_set
 571               	.LVL24:
 572               	.L45:
 135:tmk_core/common/backlight.c ****     }
 573               		.loc 1 135 9 is_stmt 1 view .LVU125
 135:tmk_core/common/backlight.c ****     }
 574               		.loc 1 135 32 is_stmt 0 view .LVU126
 575 0076 9093 0000 		sts backlight_config,r25
 576 007a 00C0      		rjmp .L46
 577               		.cfi_endproc
 578               	.LFE8:
 580               		.section	.text.backlight_level,"ax",@progbits
 581               	.global	backlight_level
 583               	backlight_level:
 584               	.LVL25:
 585               	.LFB9:
 141:tmk_core/common/backlight.c **** }
 142:tmk_core/common/backlight.c **** 
 143:tmk_core/common/backlight.c **** /** \brief Backlight set level
 144:tmk_core/common/backlight.c ****  *
 145:tmk_core/common/backlight.c ****  * FIXME: needs doc
 146:tmk_core/common/backlight.c ****  */
 147:tmk_core/common/backlight.c **** void backlight_level(uint8_t level)
 148:tmk_core/common/backlight.c **** {
 586               		.loc 1 148 1 is_stmt 1 view -0
 587               		.cfi_startproc
 588               	/* prologue: function */
 589               	/* frame size = 0 */
 590               	/* stack size = 0 */
 591               	.L__stack_usage = 0
 149:tmk_core/common/backlight.c ****     if (level > BACKLIGHT_LEVELS)
 592               		.loc 1 149 5 view .LVU128
 150:tmk_core/common/backlight.c ****         level = BACKLIGHT_LEVELS;
 151:tmk_core/common/backlight.c ****     backlight_config.level = level;
 593               		.loc 1 151 5 view .LVU129
 594               		.loc 1 151 28 is_stmt 0 view .LVU130
 595 0000 8530      		cpi r24,lo8(5)
 596 0002 00F0      		brlo .L53
 597 0004 84E0      		ldi r24,lo8(4)
 598               	.L53:
 599 0006 982F      		mov r25,r24
 600 0008 990F      		lsl r25
 601 000a 990F      		lsl r25
 602 000c 990F      		lsl r25
 603 000e 8091 0000 		lds r24,backlight_config
 604 0012 8770      		andi r24,lo8(7)
 605 0014 892B      		or r24,r25
 606 0016 8093 0000 		sts backlight_config,r24
 152:tmk_core/common/backlight.c ****     backlight_config.enable = !!backlight_config.level;
 607               		.loc 1 152 5 is_stmt 1 view .LVU131
 608               		.loc 1 152 31 is_stmt 0 view .LVU132
 609 001a 887F      		andi r24,lo8(-8)
 610 001c 91E0      		ldi r25,lo8(1)
 611 001e 01F4      		brne .L54
 612 0020 90E0      		ldi r25,0
 613               	.L54:
 614               		.loc 1 152 29 view .LVU133
 615 0022 8091 0000 		lds r24,backlight_config
 616 0026 90FB      		bst r25,0
 617 0028 80F9      		bld r24,0
 618 002a 8093 0000 		sts backlight_config,r24
 153:tmk_core/common/backlight.c ****     eeconfig_update_backlight(backlight_config.raw);
 619               		.loc 1 153 5 is_stmt 1 view .LVU134
 620 002e 0E94 0000 		call eeconfig_update_backlight
 621               	.LVL26:
 154:tmk_core/common/backlight.c ****     backlight_set(backlight_config.level);
 622               		.loc 1 154 5 view .LVU135
 623               		.loc 1 154 35 is_stmt 0 view .LVU136
 624 0032 8091 0000 		lds r24,backlight_config
 625               		.loc 1 154 5 view .LVU137
 626 0036 8695      		lsr r24
 627 0038 8695      		lsr r24
 628 003a 8695      		lsr r24
 629 003c 0C94 0000 		jmp backlight_set
 630               	.LVL27:
 631               		.cfi_endproc
 632               	.LFE9:
 634               		.section	.text.get_backlight_level,"ax",@progbits
 635               	.global	get_backlight_level
 637               	get_backlight_level:
 638               	.LFB10:
 155:tmk_core/common/backlight.c **** }
 156:tmk_core/common/backlight.c **** 
 157:tmk_core/common/backlight.c **** /** \brief Get backlight level
 158:tmk_core/common/backlight.c ****  *
 159:tmk_core/common/backlight.c ****  * FIXME: needs doc
 160:tmk_core/common/backlight.c ****  */
 161:tmk_core/common/backlight.c **** uint8_t get_backlight_level(void)
 162:tmk_core/common/backlight.c **** {
 639               		.loc 1 162 1 is_stmt 1 view -0
 640               		.cfi_startproc
 641               	/* prologue: function */
 642               	/* frame size = 0 */
 643               	/* stack size = 0 */
 644               	.L__stack_usage = 0
 163:tmk_core/common/backlight.c ****     return backlight_config.level;
 645               		.loc 1 163 5 view .LVU139
 646               		.loc 1 163 28 is_stmt 0 view .LVU140
 647 0000 8091 0000 		lds r24,backlight_config
 164:tmk_core/common/backlight.c **** }
 648               		.loc 1 164 1 view .LVU141
 649 0004 8695      		lsr r24
 650 0006 8695      		lsr r24
 651 0008 8695      		lsr r24
 652               	/* epilogue start */
 653 000a 0895      		ret
 654               		.cfi_endproc
 655               	.LFE10:
 657               		.section	.progmem.data.__c.1858,"a"
 660               	__c.1858:
 661 0000 6261 636B 		.string	"backlight step: %u\n"
 661      6C69 6768 
 661      7420 7374 
 661      6570 3A20 
 661      2575 0A00 
 662               		.section	.progmem.data.__c.1850,"a"
 665               	__c.1850:
 666 0000 6261 636B 		.string	"backlight disable\n"
 666      6C69 6768 
 666      7420 6469 
 666      7361 626C 
 666      650A 00
 667               		.section	.progmem.data.__c.1845,"a"
 670               	__c.1845:
 671 0000 6261 636B 		.string	"backlight enable\n"
 671      6C69 6768 
 671      7420 656E 
 671      6162 6C65 
 671      0A00 
 672               		.section	.progmem.data.__c.1840,"a"
 675               	__c.1840:
 676 0000 6261 636B 		.string	"backlight toggle: %u\n"
 676      6C69 6768 
 676      7420 746F 
 676      6767 6C65 
 676      3A20 2575 
 677               		.section	.progmem.data.__c.1834,"a"
 680               	__c.1834:
 681 0000 6261 636B 		.string	"backlight decrease: %u\n"
 681      6C69 6768 
 681      7420 6465 
 681      6372 6561 
 681      7365 3A20 
 682               		.section	.progmem.data.__c.1829,"a"
 685               	__c.1829:
 686 0000 6261 636B 		.string	"backlight increase: %u\n"
 686      6C69 6768 
 686      7420 696E 
 686      6372 6561 
 686      7365 3A20 
 687               		.comm	backlight_config,1,1
 688               		.text
 689               	.Letext0:
 690               		.file 2 "tmk_core/common/backlight.h"
 691               		.file 3 "/usr/local/Cellar/avr-gcc@8/8.3.0/avr/include/stdint.h"
 692               		.file 4 "tmk_core/common/debug.h"
 693               		.file 5 "tmk_core/common/avr/xprintf.h"
 694               		.file 6 "tmk_core/common/eeconfig.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 backlight.c
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:4      *ABS*:000000000000003f __SREG__
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:13     .text.backlight_init:0000000000000000 backlight_init
                            *COM*:0000000000000001 backlight_config
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:72     .text.backlight_increase:0000000000000000 backlight_increase
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:685    .progmem.data.__c.1829:0000000000000000 __c.1829
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:160    .text.backlight_decrease:0000000000000000 backlight_decrease
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:680    .progmem.data.__c.1834:0000000000000000 __c.1834
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:247    .text.backlight_enable:0000000000000000 backlight_enable
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:670    .progmem.data.__c.1845:0000000000000000 __c.1845
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:322    .text.backlight_disable:0000000000000000 backlight_disable
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:665    .progmem.data.__c.1850:0000000000000000 __c.1850
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:382    .text.backlight_toggle:0000000000000000 backlight_toggle
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:675    .progmem.data.__c.1840:0000000000000000 __c.1840
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:459    .text.is_backlight_enabled:0000000000000000 is_backlight_enabled
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:480    .text.backlight_step:0000000000000000 backlight_step
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:660    .progmem.data.__c.1858:0000000000000000 __c.1858
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:583    .text.backlight_level:0000000000000000 backlight_level
/var/folders/kv/ylqhzlcd2rs16mxjtd8q7x600000gn/T//ccctscr9.s:637    .text.get_backlight_level:0000000000000000 get_backlight_level

UNDEFINED SYMBOLS
eeconfig_is_enabled
eeconfig_init
eeconfig_read_backlight
backlight_set
eeconfig_update_backlight
debug_config
__xprintf
__do_clear_bss
